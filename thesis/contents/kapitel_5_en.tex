\section{Simulation and Results}
\label{Chapter:Sim}

This chapter summarises the observations, implementations, and consequent results of Koopman operator theory's application on the Arm-Driven Inverted Pendulum. Since it is infeasible to work with infinite-dimensional models, even though they are linear, the infinite-dimensional Koopman operator is projected onto a finite-dimensional space where the finite-dimensional (approximate)~Koopman operator is a linear operator approximated by data-driven regression methods such as Dynamic Mode Decomposition. The various data-driven regression methods and their respective applications have been discussed in the previous sections.\par
The essence of data-driven regression is naturally the measured data, and care must be taken on the choices made to record this data; for example, whether the data must be recorded with or without the influence of a forcing function, whether the identification should be made in open-loop or closed-loop, whether the data should be captured from a single trajectory or multiple trajectories etc. This chapter aims to answer such questions by investigating the results of various choices.\par
The choice of system identification (open-loop or closed-loop) to collect the necessary measurement data is first investigated in Section \ref{sec:Results_ident}. Since the final goal is tracking a reference trajectory, it is important to identify the system dynamics in the up-up configuration. However, this poses a serious challenge because firstly, the equilibrium of the up-up configuration is unstable and to add to that, the dynamics of the ADIP are chaotic, i.e., the system can evolve along drastically different trajectories for a small variation in the initial conditions, and it is very challenging (and maybe not even possible) to estimate the dynamics of ADIP in open-loop about the up-up configuration. Therefore, it is necessary to identify the system in closed-loop. This too proves problematic in the context of implementation as one needs to have a stabilizing controller already. Without knowledge of dynamics, it is challenging to synthesize such a controller. Nevertheless, assuming that a non-model based controller can be synthesized for an unstable but controllable nonlinear dynamical system, it is possible to estimate the system's closed-loop dynamics. \par 
In this thesis work, however, since the ADIP is a relatively simple system when compared to systems with complex dynamical interactions of the state (which can also be high-dimensional to add to the complexity), a mathematical model was derived as presented in Chapter \ref{Chapter:Plant}. A model-based feedback controller, the LQR was subsequently designed for the ADIP, and closed-loop reference tracking was executed to collect the required measurement data. An important observation is in order concerning finding a stabilizing controller in the absence of a mathematical model, as discussed previously. The data-driven controller's ultimate goal is to track a reference trajectory nearly as good as the model-based controller and if possible, extend the range of tracking. However, a data-driven model is only as good as the measured data, i.e. it is most probable to work in the measured data range. To this end, it was of interest to analyze an iterative approach to derive the best possible data-driven controller with data captured from a limited range of trajectory. It was observed that data recorded for a small range of motion was enough to capture the system's dominant closed-loop dynamics. Therefore, the model derived from such data can be iterated to obtain a reasonably close approximation of the model derived from data recorded over a larger range. This particular method of deriving a data-driven approximation could be particularly useful in designing data-driven controllers for highly unstable systems for which no prior knowledge of dynamics exist and can only be controlled in a small region around the unstable equilibrium. This is further explained at the end of this chapter. \par
It is important to note that although the region of interest for this thesis is the up-up configuration for which it is necessary to perform closed-loop system identification, open-loop identification for the ADIP around the stable equilibrium point provides many useful and important insights into the methods of data collection and the choice of observables for prediction and control. The knowledge derived from open-loop system identification is applied to measurement data and choice of observables for the closed-loop system. This has been elaborately discussed in Section \ref{sec:Results_ident}. Furthermore, the choice of identification signal also varies from open-loop identification to closed-loop identification. In open-loop identification, a chirp signal was used to excite the plant around the stable equilibrium. In closed-loop identification, the input signal was simply the control input generated by a suitable controller corrupted by some white noise. White noise is added to the control input to differentiate the plant dynamics from input dynamics. One can also kick the closed-loop system occasionally with an impulse input for this purpose.\par
Section \ref{sec:ResultsTrack} presents some comparisons of controllers such as the LQR with integral action~(LQi) and a model predictive controller~(MPC) applied to a \textit{local} model versus a data-driven model. The \textit{local} model is simply a linear approximation of the nonlinear dynamics of the ADIP locally linearized at the Up-Up position~($\phi_1 = \phi_2 = 0^\circ$). The effect of the choice of observables is investigated in this section. Furthermore, the data-driven model's performance is compared with a quasi-linear parameter varying model of the ADIP. \par
Finally, Section \ref{sec:Results_swingup} compares an energy-based swing up approach as presented in \cite{Fantoni} with a linear model predictive control approach where the nonlinear ADIP model is approximated by a quasi-linear parameter varying model as presented in \cite{qLMPC}. Although the authors here use the idea to evaluate a reference tracking objective with a qLPV, it was of interest to investigate if this approach could also be applied for linear model based swing-up of the inverted pendulum.   
\newpage
% 
%
\input{contents/ResultsIdent}
\input{contents/ResultsTracking}
\input{contents/Results_swingup}
% % 
% % There was also an attempt to isolate the dominant dynamics at the stable equillibrium and use them as observables at the unstable point, but this proved to be futile since things don't exactly work that easily. Talk about this.



